name: autoperf
version: "0.1"
author: Gerd Zellweger <mail@gerdzellweger.com>
about: Uses less domain knowledge, but more time.
args:
    - verbose:
        short: v
        multiple: true
        help: Sets the level of verbosity
subcommands:
    - stats:
        about: Generates statistics about performance events.
        args:
            - directory:
                help: Output folder.
                required: true
    - profile:
        settings:
            - TrailingVarArg
        about: Measure all available H/W events for a command using `perf stat`.
        args:
            - debug:
                short: d
                long: debug
                help: Print debug information verbosely.
            - output:
                short: o
                long: output
                help: Set output directory.
                value_name: DIRECTORY
                takes_value: true
            - record:
                short: r
                long: record
                help: Use `perf record` instead of `perf stat` (not recommended due to sampling rate differences).
                takes_value: true
            - COMMAND:
                help: Command to execute.
                required: true
                multiple: true
    - scale:
        settings:
            - TrailingVarArg
        about: Measure all available H/W events for commands using `perf stat` with increasing number of threads.
        args:
            - debug:
                short: d
                long: debug
                help: Print debug information verbosely.
            - dryrun:
                short: r
                long: dryrun
                help: Don't run anything, just print what it would do.
            - directory:
                help: Path of manifest directory.
                required: true
    - pair:
        about: Run every program in the manifest alone as well as pairwise together and measure all events.
        args:
            - debug:
                short: d
                long: debug
                help: Print verbose debug information.
            - start:
                short: b
                long: base
                help: Skip the first x configuration (used to evaluate the same manifest simultaneously on multiple identical machines).
                takes_value: true
            - step:
                short: s
                long: step
                help: Only evaluate every x-th configuration (used to evaluate the same manifest simultaneously on multiple identical machines).
                takes_value: true
            - dryrun:
                short: r
                long: dryrun
                help: Don't run anything, just print what it would do.
            - directory:
                help: Path of manifest directory.
                required: true
    - extract:
        about: Merge counter measurements generated with the `profile` command in a single CSV file.
        args:
            - debug:
                short: d
                long: debug
                help: Print verbose debug information.
            - core:
                short: c
                long: core
                takes_value: true
                possible_values: [ all, exclusive, none ]
                help: Which core events to include (default exclusive).
            - uncore:
                short: u
                long: uncore
                takes_value: true
                possible_values: [ all, shared, exclusive, none ]
                help: Which uncore events to include (default exclusive).
            - directory:
                help: Set input directory.
                required: true
